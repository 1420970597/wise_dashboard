import{r as i}from"./react.DgAoxHLg.js";import{t as N,G as F,d as M}from"./number-flow.CoOLLoAi.js";var E;const _=parseInt((E=i.version.match(/^(\d+)\./))==null?void 0:E[1]),m=_>=19,C=["data","digits"];class p extends F{attributeChangedCallback(t,n,e){this[t]=JSON.parse(e)}}p.observedAttributes=m?[]:C;N("number-flow-react",p);const f={},R=m?o=>o:JSON.stringify;function w(o){const{transformTiming:t,spinTiming:n,opacityTiming:e,animated:a,respectMotionPreference:r,trend:s,plugins:c,...u}=o;return[{transformTiming:t,spinTiming:n,opacityTiming:e,animated:a,respectMotionPreference:r,trend:s,plugins:c},u]}class T extends i.Component{updateProperties(t){if(!this.el)return;this.el.manual=!this.props.isolate;const[n]=w(this.props);Object.entries(n).forEach(([e,a])=>{this.el[e]=a??p.defaultProps[e]}),t!=null&&t.onAnimationsStart&&this.el.removeEventListener("animationsstart",t.onAnimationsStart),this.props.onAnimationsStart&&this.el.addEventListener("animationsstart",this.props.onAnimationsStart),t!=null&&t.onAnimationsFinish&&this.el.removeEventListener("animationsfinish",t.onAnimationsFinish),this.props.onAnimationsFinish&&this.el.addEventListener("animationsfinish",this.props.onAnimationsFinish)}componentDidMount(){this.updateProperties(),m&&this.el&&(this.el.digits=this.props.digits,this.el.data=this.props.data)}getSnapshotBeforeUpdate(t){var n;if(this.updateProperties(t),t.data!==this.props.data){if(this.props.group)return this.props.group.willUpdate(),()=>{var e;return(e=this.props.group)==null?void 0:e.didUpdate()};if(!this.props.isolate)return(n=this.el)==null||n.willUpdate(),()=>{var e;return(e=this.el)==null?void 0:e.didUpdate()}}return null}componentDidUpdate(t,n,e){e==null||e()}handleRef(t){this.props.innerRef&&(this.props.innerRef.current=t),this.el=t}render(){const[t,{innerRef:n,className:e,data:a,willChange:r,isolate:s,group:c,digits:u,onAnimationsStart:l,onAnimationsFinish:h,...d}]=w(this.props);return i.createElement("number-flow-react",{ref:this.handleRef,"data-will-change":r?"":void 0,class:e,"aria-label":a.valueAsString,...d,role:"img",dangerouslySetInnerHTML:{__html:""},suppressHydrationWarning:!0,digits:R(u),data:R(a)})}constructor(t){super(t),this.handleRef=this.handleRef.bind(this)}}const y=i.forwardRef(function({value:t,locales:n,format:e,prefix:a,suffix:r,...s},c){i.useImperativeHandle(c,()=>u.current,[]);const u=i.useRef(),l=i.useContext(S);l==null||l.useRegister(u);const h=i.useMemo(()=>n?JSON.stringify(n):"",[n]),d=i.useMemo(()=>e?JSON.stringify(e):"",[e]),b=i.useMemo(()=>{var g;const A=f[g=`${h}:${d}`]??(f[g]=new Intl.NumberFormat(n,e));return M(t,A,a,r)},[t,h,d,a,r]);return i.createElement(T,{...s,group:l,data:b,innerRef:u})}),S=i.createContext(void 0);function I({children:o}){const t=i.useRef(new Set),n=i.useRef(!1),e=i.useRef(new WeakMap),a=i.useMemo(()=>({useRegister(r){i.useEffect(()=>(t.current.add(r),()=>{t.current.delete(r)}),[])},willUpdate(){n.current||(n.current=!0,t.current.forEach(r=>{const s=r.current;!s||!s.created||(s.willUpdate(),e.current.set(s,!0))}))},didUpdate(){t.current.forEach(r=>{const s=r.current;!s||!e.current.get(s)||(s.didUpdate(),e.current.delete(s))}),n.current=!1}}),[]);return i.createElement(S.Provider,{value:a},o)}export{I as N,y as a};
